---
title: Polling Example
description: Polling Ticker Example
---

import { Tabs } from 'nextra/components';
import PollExample from './PollExample';
import Example from '@/components/Example';

# Polling Ticker Example

Demonstrates infinite server polling ticker in a `while(true){:ts}` loop that's used to reconnect when the connection is safely closed by the server. The client-side sends `i` parameter to the server-side in a query, the server increments it and streams the result back to the client. After 10 iterations, the server ends the response and the client starts polling again. Open devtools to see network requests.

## Result

<Example>
  <PollExample />
</Example>

## Code

<Tabs items={['PollController.ts', 'PollExample.tsx']}>
  <Tabs.Tab>
```ts showLineNumbers copy filename="src/modules/polling/PollController.ts" repository="finom/vovk-examples"
import { get, prefix } from 'vovk';
import { withZod } from 'vovk-zod';
import { z } from 'zod';

@prefix('polling')
export default class PollController {
@get('', { cors: true })
static streamPollResponse = withZod({
query: z.object({
i: z.string(),
}),
iteration: z.object({
i: z.number(),
}),
async \*handle(req) {
let i = parseInt(req.vovk.query().i);
while (true) {
yield { i: ++i };
await new Promise((resolve) => setTimeout(resolve, 1000));
if (!(i % 10)) {
break;
}
}
},
});
}

````
*[The code above is fetched from GitHub repository.](https://github.com/finom/vovk-examples/blob/main/src/modules/polling/PollController.ts)*
  </Tabs.Tab>
  <Tabs.Tab>
```tsx showLineNumbers copy filename="src/app/polling/PollExample.tsx" repository="finom/vovk-examples"
'use client';
import { useEffect, useState } from 'react';
import { PollRPC } from '@/client';

export default function PollExample() {
  const [tick, setTick] = useState(0);
  useEffect(() => {
    void (async () => {
      let i = 0;
      while (true) {
        using iterable = await PollRPC.streamPollResponse({
          query: { i: i.toString() },
        });

        for await ({ i } of iterable) {
          setTick(i);
        }
      }
    })();
  }, []);

  return (
    <div>
      <p>Poll Ticker</p>
      <h2>{tick}</h2>
    </div>
  );
}
````

_[The code above is fetched from GitHub repository.](https://github.com/finom/vovk-examples/blob/main/src/app/polling/PollExample.tsx)_

  </Tabs.Tab>
</Tabs>

## Related Documentation

- [Real-time Polling](https://vovk.dev/polling)
- [Validation](https://vovk.dev/validation/introduction)
- [TypeScript RPC](https://vovk.dev/typescript)
- [Controller](https://vovk.dev/controller)
- [`@operation` Decorator](https://vovk.dev/openapi)
